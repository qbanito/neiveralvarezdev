# ğŸ§  Email Automation System v2.0

## Sistema Completo de Emails Inteligentes

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ğŸ“Š DATA SOURCES                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   APIFY                    WEBSITE SCRAPING              MEMORY         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚ Leads   â”‚             â”‚ Company Site    â”‚          â”‚ Previous â”‚    â”‚
â”‚   â”‚ Dataset â”‚             â”‚ Analysis        â”‚          â”‚ Emails   â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜    â”‚
â”‚        â”‚                           â”‚                         â”‚         â”‚
â”‚        â–¼                           â–¼                         â–¼         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚                   ğŸ”¬ LEAD ENRICHER                          â”‚     â”‚
â”‚   â”‚  â€¢ Extrae info de la empresa                                â”‚     â”‚
â”‚   â”‚  â€¢ Detecta problemas especÃ­ficos                            â”‚     â”‚
â”‚   â”‚  â€¢ Identifica "hooks" de personalizaciÃ³n                    â”‚     â”‚
â”‚   â”‚  â€¢ Recomienda servicios relevantes                          â”‚     â”‚
â”‚   â”‚  â€¢ Determina variante A/B/C para primer email               â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                    â”‚                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ğŸ§  INTELLIGENCE LAYER                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚ CONVERSATION MEMORY â”‚     â”‚      ADAPTIVE SEQUENCE              â”‚  â”‚
â”‚   â”‚                     â”‚     â”‚                                     â”‚  â”‚
â”‚   â”‚ â€¢ Track opens       â”‚     â”‚  â”Œâ”€â”€â”€â”€â”€â”                            â”‚  â”‚
â”‚   â”‚ â€¢ Track clicks      â”‚â”€â”€â”€â”€â–¶â”‚  â”‚Emailâ”‚â”€â”€â–¶ Open? â”€â”€â–¶ Click?        â”‚  â”‚
â”‚   â”‚ â€¢ Track replies     â”‚     â”‚  â”‚  1  â”‚      â”‚         â”‚           â”‚  â”‚
â”‚   â”‚ â€¢ Engagement level  â”‚     â”‚  â””â”€â”€â”¬â”€â”€â”˜      â–¼         â–¼           â”‚  â”‚
â”‚   â”‚   (hot/warm/cold)   â”‚     â”‚     â”‚     Curious    Interested     â”‚  â”‚
â”‚   â”‚ â€¢ Pattern detection â”‚     â”‚     â”‚        â”‚           â”‚          â”‚  â”‚
â”‚   â”‚   (ghost/opener/    â”‚     â”‚     â–¼        â–¼           â–¼          â”‚  â”‚
â”‚   â”‚    engaged)         â”‚     â”‚  Different  Send      Send Demo     â”‚  â”‚
â”‚   â”‚                     â”‚     â”‚  Subject    Question   Faster       â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚                                     â”‚  â”‚
â”‚                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         âœï¸ EMAIL GENERATION                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚   â”‚                 ğŸ¤– OpenAI GPT-4 Personalizer                â”‚      â”‚
â”‚   â”‚                                                             â”‚      â”‚
â”‚   â”‚  INPUTS:                    OUTPUTS:                        â”‚      â”‚
â”‚   â”‚  â€¢ Lead data (name, role)   â€¢ Unique subject line           â”‚      â”‚
â”‚   â”‚  â€¢ Enriched company info    â€¢ Personalized body             â”‚      â”‚
â”‚   â”‚  â€¢ Detected problems        â€¢ Natural human tone            â”‚      â”‚
â”‚   â”‚  â€¢ Previous email context   â€¢ References past conversations â”‚      â”‚
â”‚   â”‚  â€¢ Behavior pattern         â€¢ Adapts angle based on pattern â”‚      â”‚
â”‚   â”‚  â€¢ Recommended variant      â€¢ A/B/C testing built-in        â”‚      â”‚
â”‚   â”‚                                                             â”‚      â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                         â”‚
â”‚   6 EMAIL TYPES:                                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   â”‚ Detective â”‚ Resource  â”‚   Demo    â”‚   Case    â”‚ Question  â”‚ Friend â”‚
â”‚   â”‚ (Day 0)   â”‚ (Day 3)   â”‚ (Day 7)   â”‚ (Day 11)  â”‚ (Day 15)  â”‚(Day 21)â”‚
â”‚   â”‚           â”‚           â”‚           â”‚           â”‚           â”‚        â”‚
â”‚   â”‚ "I notice â”‚ "Free     â”‚ "Quick    â”‚ "Similar  â”‚ "Simple   â”‚ "Last  â”‚
â”‚   â”‚  problem" â”‚  resource"â”‚  demo"    â”‚  case"    â”‚  question"â”‚  email"â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                                                                         â”‚
â”‚   FIRST EMAIL VARIANTS (A/B/C Testing):                                 â”‚
â”‚   â€¢ Variant A: Problem-Focused (for tech roles)                         â”‚
â”‚   â€¢ Variant B: Curiosity (for executives)                               â”‚
â”‚   â€¢ Variant C: Value-First (for marketing/sales)                        â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ğŸ“¤ SENDING & TRACKING                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  RESEND  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚   WEBHOOKS   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  UPDATE MEMORY    â”‚  â”‚
â”‚   â”‚   API    â”‚         â”‚              â”‚         â”‚                   â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚ â€¢ delivered  â”‚         â”‚ â€¢ Mark opens      â”‚  â”‚
â”‚                        â”‚ â€¢ opened     â”‚         â”‚ â€¢ Track clicks    â”‚  â”‚
â”‚   Features:            â”‚ â€¢ clicked    â”‚         â”‚ â€¢ Log replies     â”‚  â”‚
â”‚   â€¢ Rate limiting      â”‚ â€¢ bounced    â”‚         â”‚ â€¢ Adjust sequence â”‚  â”‚
â”‚   â€¢ BCC to Gmail       â”‚ â€¢ complained â”‚         â”‚ â€¢ Stop if replied â”‚  â”‚
â”‚   â€¢ Reply forwarding   â”‚              â”‚         â”‚                   â”‚  â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


## ğŸ“ File Structure

```
automation/
â”œâ”€â”€ sender.js                 # ğŸ“§ Main sender (orchestrates everything)
â”œâ”€â”€ openai-personalizer.js    # ğŸ¤– AI email generation with GPT-4
â”œâ”€â”€ lead-enricher.js          # ğŸ”¬ Deep company analysis
â”œâ”€â”€ lead-researcher.js        # ğŸ” Lead research from Apify data
â”œâ”€â”€ conversation-memory.js    # ğŸ§  Track email history & behavior
â”œâ”€â”€ adaptive-sequence.js      # ğŸ”€ Dynamic sequence logic
â”œâ”€â”€ config.js                 # âš™ï¸ Configuration & settings
â”œâ”€â”€ apify-fetcher.js          # ğŸ“¥ Fetch leads from Apify
â””â”€â”€ email-personalizer.js     # ğŸ“ Basic personalization (fallback)
```


## ğŸ”„ Flow for Each Email

```
1. Get lead from queue
        â†“
2. Enrich with lead-enricher.js
   â€¢ Scrape company website
   â€¢ Detect problems
   â€¢ Find personalization hooks
   â€¢ Recommend A/B/C variant
        â†“
3. Check conversation-memory.js
   â€¢ How many emails sent?
   â€¢ Any opens/clicks?
   â€¢ What pattern? (ghost/opener/engaged)
        â†“
4. Get next action from adaptive-sequence.js
   â€¢ Send? Skip? Stop?
   â€¢ Which email type?
   â€¢ Which variant?
        â†“
5. Generate email with openai-personalizer.js
   â€¢ Pass all enriched data
   â€¢ Include conversation context
   â€¢ Get unique subject + body
        â†“
6. Send via Resend
   â€¢ Track with headers
   â€¢ BCC for review
        â†“
7. Log to conversation-memory.js
   â€¢ Store what was sent
   â€¢ Ready for next decision
```


## ğŸ“Š Personalization Levels

| Level | Data Used | Example |
|-------|-----------|---------|
| **Basic** | Name, Company | "Hey John, I see you work at Acme..." |
| **Industry** | Industry, Role | "As a Marketing Director in SaaS..." |
| **Company-Specific** | Website analysis | "I noticed your checkout flow has 5 steps..." |
| **Problem-Aware** | Detected issues | "That testimonials section could be getting 3x more conversions..." |
| **Context-Aware** | Previous emails | "I know I mentioned the demo last week..." |
| **Behavior-Adaptive** | Opens/clicks | Different approach if ghosting vs engaging |


## ğŸ¯ Adaptive Behaviors

| Lead Pattern | Detection | Sequence Adjustment |
|--------------|-----------|---------------------|
| **Ghost** | No opens | Try different subject lines, then breakup |
| **Opener** | Opens but no clicks | Ask direct questions |
| **Engaged** | Clicks links | Fast-track to demo |
| **Hot** | Replies | STOP sequence, manual follow-up |


## ğŸ”‘ API Keys Required

```env
RESEND_API_KEY=re_xxxxx           # For sending emails
OPENAI_API_KEY=sk-proj-xxxxx      # For AI generation
APIFY_API_TOKEN=apify_api_xxxxx   # For fetching leads
```


## ğŸš€ Running

```bash
# Test single email
node automation/test-ai-email.js

# Run full campaign
node automation/sender.js

# With force send (bypass time restrictions)
FORCE_SEND=true node automation/sender.js
```


## ğŸ“ˆ GitHub Actions Schedule

- **Monday - Friday**
- **3x daily**: 9:00 AM, 1:00 PM, 5:00 PM UTC
- Automatically fetches new leads and sends personalized emails
